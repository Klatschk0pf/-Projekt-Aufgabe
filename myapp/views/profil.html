<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Dein Profil</title>
</head>
<body>
  <h1>Willkommen, <span id="username"></span>!</h1>
  <p>Name: <span id="name"></span></p>
  <p>Geschlecht: <span id="gender"></span></p>
  <p>Geburtstag: <span id="birthday"></span></p>
  <div id="profile-picture-container"></div>
  <p><a href="/profil-bearbeiten.html">Profil bearbeiten</a></p>
  <p><a href="/logout">Logout</a></p>
  <script>
    fetch('/api/profil')
      .then(res => {
        if (!res.ok) throw new Error("Nicht eingeloggt oder Fehler beim Abrufen");
        return res.json();
      })
      .then(user => {
        document.getElementById('username').textContent = user.username;
        document.getElementById('name').textContent = user.name || 'nicht angegeben';
        document.getElementById('gender').textContent = user.gender || 'nicht angegeben';
        document.getElementById('birthday').textContent = user.birthday || 'nicht angegeben';
        if (user.profile_picture) {
          const img = document.createElement('img');
          img.src = user.profile_picture;
          img.alt = "Profilbild";
          img.width = 200;
          document.getElementById('profile-picture-container').appendChild(img);
        }
      })
      .catch(err => {
        document.body.innerHTML = `<p>Fehler: ${err.message}</p><a href="/login">Login</a>`;
      });
  </script>
</body>
</html>
